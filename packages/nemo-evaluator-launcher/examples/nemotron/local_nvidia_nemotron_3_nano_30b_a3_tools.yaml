# SPDX-FileCopyrightText: Copyright (c) 2025, NVIDIA CORPORATION. All rights reserved.
# SPDX-License-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# This config evaluates Nemotron 3 Nano 30B A3B with tool usage (Python code execution).
# The model can use a Python interpreter tool to solve math and science problems.
#
# How to use:
# 1. copy this file locally or clone the repository
# 2. run `nemo-evaluator-launcher run --config path/to/local_nvidia_nemotron_3_nano_30b_a3_tools.yaml`

defaults:
  - execution: local
  - deployment: none
  - _self_

execution:
  output_dir: ./results_nvidia_nemotron_3_nano_30b_a3b_tools
  mounts:
    evaluation:
      ./hf_cache: /root/.cache/huggingface
target:
  api_endpoint:
    model_id: nvidia/nemotron-3-nano-30b-a3b
    url: https://integrate.api.nvidia.com/v1/chat/completions
    api_key_name: NGC_API_KEY

evaluation:
  env_vars:
    HF_TOKEN: $host:HF_TOKEN
    HF_HOME: $host:HF_HOME
  nemo_evaluator_config:
    config:
      params:
        max_new_tokens: 131072
        temperature: 0.99999
        top_p: 0.99999
        parallelism: 1
        request_timeout: 3600
        max_retries: 10
        extra:
          tokenizer: NVIDIA-Nemotron-Nano-3-30B-A3B-BF16
          tokenizer_backend: huggingface
    target:
      api_endpoint:
        adapter_config:
          use_caching: true
          tracking_requests_stats: true
          log_failed_requests: true
          use_request_logging: true
          max_logged_requests: 10
          use_response_logging: true
          max_logged_responses: 10
  tasks:
  - name: ns_aime2025
    nemo_evaluator_config:
      config:
        params:
          extra:
            use_sandbox: true
            num_repeats: 64
            args: "++inference.tokens_to_generate=null ++tool_modules=[nemo_skills.mcp.servers.python_tool::PythonTool]"
  - name: ns_gpqa
    nemo_evaluator_config:
      config:
        params:
          extra:
            use_sandbox: true
            num_repeats: 8
            args: "++inference.tokens_to_generate=null ++prompt_config=eval/aai/mcq-4choices ++tool_modules=[nemo_skills.mcp.servers.python_tool::PythonTool]"
