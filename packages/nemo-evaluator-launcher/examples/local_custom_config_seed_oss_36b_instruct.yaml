# Run this config with `nv-eval run --config-dir examples --config-name local_llama_3_1_8b_instruct`.

# Commented out values show an example of how to override the config values from this file.

# To see the full config, run `nv-eval run --config-dir examples --config-name local_llama_3_1_8b_instruct --dry-run`


# specify default configs for execution and deployment
defaults:
  - execution: local
  - deployment: none
  - _self_


execution:
  output_dir: seed-oss-36b-instruct


target:
  api_endpoint:
    model_id: bytedance/seed-oss-36b-instruct
    url: https://integrate.api.nvidia.com/v1/chat/completions
    api_key_name: NGC_API_KEY  # API Key with access to build.nvidia.com


# specify the benchmarks to evaluate
evaluation:
  nemo_evaluator_config: 
    config: # global config settings that apply to all tasks
      params:
        request_timeout: 3600  # timeout for API request in seconds
  tasks:
    - name: mgsm
      nemo_evaluator_config:  # task-specific configuration for mgsm benchmark
        target:
          api_endpoint:
            adapter_config:
              caching_dir: /results/cache
              endpoint_type: chat
              interceptors:
                - name: "payload_modifier"  # modifies API request payload with custom parameters
                  config:
                    params_to_add:
                      extra_body:
                        chat_template_kwargs:
                          enable_thinking: false
                        thinking_budget: -1
                - name: system_message  # injects a system message to guide model behavior
                  enabled: true
                  config:
                    system_message: |
                      You are an expert mathematician and problem solver. When presented with a math problem:

                      1. Read the problem carefully and understand what is being asked
                      2. Break down the problem into smaller, manageable steps
                      3. Show your reasoning clearly and logically
                      4. Use appropriate mathematical notation and methods
                      5. Double-check your work for accuracy
                      6. Present your final answer clearly within \boxed{} tags

                      Always think step by step and be thorough in your explanations.
                - name: request_logging  # logs API requests for debugging and monitoring
                  enabled: true
                  config:
                    max_requests: 1  # limit number of requests to log

                - name: caching  # caches API responses to avoid redundant calls
                  enabled: true
                  config:
                    cache_dir: /results/cache
                    reuse_cached_responses: true

                - name: endpoint  # handles actual API communication
                  enabled: true
                - name: response_stats  # collects statistics about API responses
                  enabled: true
